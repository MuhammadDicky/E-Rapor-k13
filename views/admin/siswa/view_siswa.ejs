<%- include ../../partials/admin_layout/header.ejs %>
<%- include ../../partials/admin_layout/sidebar.ejs %>
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">

  <!-- Main content -->
  <!-- Main content -->
  <section class="content">
    <div class="row">
      <div class="col-md-12">
        <% if(action === "view") { %>
        <div class="nav-tabs-custom">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#activity" data-toggle="tab">Lihat Siswa</a></li>
            <li><a href="#input-siswa" data-toggle="tab">Input Siswa</a></li>
          </ul>
          <div class="tab-content">
            <div class="active tab-pane" id="activity">
              <div class="box-body table-responsive no-padding">
                <table id="siswa" class="table table-hover">
                  <thead>
                    <th>No.</th>
                    <th>Nisn</th>
                    <th>Nama</th>
                    <th>Aksi</th>
                  </thead>
                  <tbody>
                    <% for (var i = 0; i < siswa.length; i++) { %>
                    <tr>
                      <td>
                        <%= i+1 %>
                      </td>
                      <td>
                        <%= siswa[i].nisn %>
                      </td>
                      <td>
                        <%= siswa[i].nama %>
                      </td>
                      <td>
                        <a class="btn btn-success btn-sm" href="/admin/mahasiswa/edit/<%= siswa[i].id %>">
                          <span class="glyphicon glyphicon-edit"></span>
                          Edit
                        </a>
                        <button class="btn btn-danger btn-sm" data-id="<%= siswa[i].id %>">
                          <span class="glyphicon glyphicon-remove"></span>
                          Delete
                        </button>
                      </td>
                    </tr>
                    <% } %>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- /.tab-pane -->
            <div class="tab-pane" id="input-siswa">
              <div class="box-body">
                <!-- form input mahasiswa -->
                <form action="/admin/siswa/create" method="post">

                  <div class="row">
                    <div class="col-md-3">
                      <div class="form-group">
                        <label for="nis" class="control-label">NIS</label>
                        <input type="text" name="nis" class="form-control" id="nis" required>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="nisn" class="control-label">NISN</label>
                        <input type="text" name="nisn" class="form-control" id="nisn" required>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="nama" class="control-label">Nama</label>
                        <input type="text" name="nama" class="form-control" id="nama" required>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <!-- select -->
                      <div class="form-group">
                        <label>Jenis Kelamin</label>
                        <select required name="jk" class="form-control">
                          <option value="">--- Pilih Jenis Kelamin ---</option>
                          <option value="pria">Pria</option>
                          <option value="wanita">Wanita</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="tmp_lahir" class="control-label">Tempat Lahir</label>
                        <input type="text" name="tmp_lahir" class="form-control" id="tmp_lahir" required>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="tgl_lahir" class="control-label">Tgl Lahir</label>
                        <input type="date" name="tgl_lahir" class="form-control" id="tgl_lahir" required>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <!-- select -->
                      <div class="form-group">
                        <label>Agama</label>
                        <select required name="agama" class="form-control">
                          <option value="">--- Pilih Agama ---</option>
                          <option value="Islam">Islam</option>
                          <option value="Katolik">Katolik</option>
                          <option value="Kristen">Kristen</option>
                          <option value="Hindu">Hindu</option>
                          <option value="Buddha">Buddha</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-7">
                      <div class="form-group">
                        <label for="alamat" class="control-label">Alamat</label>
                        <input type="text" name="alamat" class="form-control" id="alamat">
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="form-group">
                        <label for="no_telp" class="control-label">No. Telp</label>
                        <input type="text" name="no_telp" class="form-control" id="no_telp">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-7">
                      <div class="form-group">
                        <label for="asal_sekolah" class="control-label">Sekolah Asal</label>
                        <input type="text" name="asal_sekolah" class="form-control" id="asal_sekolah">
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="form-group">
                        <label for=" alamat_asal_sekolah" class="control-label">Alamat Sekolah Asal</label>
                        <input type="text" name=" alamat_asal_sekolah" class="form-control" id=" alamat_asal_sekolah">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="diterima_kelas" class="control-label">Diterima di kelas</label>
                        <!-- select -->
                        <select required name="diterima_kelas" id="diterima_kelas" class="form-control">
                          <option value="">--- Pilih Di Kelas ---</option>
                          <option value="VII">VII</option>
                          <option value="VIII">VIII</option>
                          <option value="IX">IX</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="tgl_diterima" class="control-label">Diterima Tgl</label>
                        <input type="date" name="tgl_diterima" class="form-control" id="tgl_diterima">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="no_ijazah" class="control-label">No. Ijazah</label>
                        <input type="text" name="no_ijazah" class="form-control" id="no_ijazah">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="tahun_ijazah" class="control-label">Thn Ijazah</label>
                        <input type="text" name="tahun_ijazah" class="form-control" id="tahun_ijazah">
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-group">
                        <label for="kode" class="control-label">No. SKHUN</label>
                        <input type="text" name="skhun_no" class="form-control" id="skhun_no">
                      </div>
                    </div>
                    <div class="col-md-1">
                      <div class="form-group">
                        <label for="no_skhu" class="control-label" style="font-size: 10px">Thn SKHUN</label>
                        <input type="text" name="no_skhu" class="form-control" id="no_skhu">
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-3">
                      <div class="form-group">
                        <label for="ortu_ayah" class="control-label">Nama Ayah</label>
                        <input type="text" name="ortu_ayah" class="form-control" id="ortu_ayah">
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-group">
                        <label for="ortu_ibu" class="control-label">Nama Ibu</label>
                        <input type="text" name="ortu_ibu" class="form-control" id="ortu_ibu">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="alamat_ortu" class="control-label">Alamat Ortu</label>
                        <input type="text" name="alamat_ortu" class="form-control" id="alamat_ortu">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="no_ortu" class="control-label">Telp Ortu</label>
                        <input type="text" name="no_ortu" class="form-control" id="no_ortu">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="pkj_ortu_ayah" class="control-label">Pekerjaan Ayah</label>
                        <input type="text" name="pkj_ortu_ayah" class="form-control" id="pkj_ortu_ayah">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="pkj_ortu_bu" class="control-label">Pekerjaan Ibu</label>
                        <input type="text" name="pkj_ortu_bu" class="form-control" id="pkj_ortu_bu">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="wali" class="control-label">Nama wali</label>
                        <input type="text" name="wali" class="form-control" id="wali">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="alamat_wali" class="control-label">Alamat Wali</label>
                        <input type="text" name="alamat_wali" class="form-control" id="alamat_wali">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="no_wali" class="control-label">No. Wali</label>
                        <input type="text" name="no_wali" class="form-control" id="no_wali">
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="form-group">
                        <label for="pkj_wali" class="control-label">Pekerjaan Wali</label>
                        <input type="text" name="pkj_wali" class="form-control" id="pkj_wali">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group">
                        <label for="foto" class="control-label">Foto Siswa</label>
                        <input type="file" name="foto" class="form-control" id="foto">
                      </div>
                    </div>
                  </div>

                  <div class="box-footer">
                    <button type="submit" class="btn btn-primary pull-left">
                      Simpan
                    </button>
                  </div>
                  <!-- /.box-footer -->
                </form>
              </div>
            </div>
            <!-- /.tab-pane -->

          </div>
          <!-- /.tab-content -->
        </div>
        <% } %>
        <!-- /.nav-tabs-view -->
      </div>
    </div>
  </section>
</div>
<!-- /.content -->




<%- include ../../partials/admin_layout/footer.ejs %>
<!-- page script -->
<script>
  $(document).ready(function () {
    // datatable
    $('#siswa').DataTable()

    // redirect halaman siswa
    function halamansiswa() {
      window.location.replace(window.location.protocol + "//" + window.location.host + '/admin/siswa')
    }

    // function simpan
    $('#simpan_siswa').on('submit', function (event) {
      event.preventDefault();
      $.ajax({
        url: "/admin/siswa/create",
        method: "POST",
        data: $(this).serialize(),
        success: function () {
          swal({
            title: "Success",
            text: "Success Tambah Data siswa",
            icon: "success",
            button: "Oke",
          }).then(sukses => {
            halamansiswa();
          });
        },
      })
    })

    //showing data to e edit modal 
    $('#siswa').on('click', '.edit', function () {
      const id = $(this).data('id');
      const nama = $(this).data('nama');

      $('#edit-modal').modal('show');
      $('.id').val(id);
      $('.nama').val(nama);
    });
  })

  // Delete guru 
  function delete_siswa(id) {
    let idsiswa = id;
    swal({
      title: "Yakin Ingin Menghapus Data siswa ini?",
      text: "Data yang dihapus, tidak bisa kembali lagi.",
      icon: "warning",
      buttons: true,
      dangerMode: true
    }).then(willDelete => {
      if (willDelete) {
        swal({
          title: "Success",
          text: "Success Delete Data siswa",
          icon: "success",
          button: "Oke",
        }).then(suksesDelete => {
          window.location.assign(`/admin/siswa/delete/${idsiswa}`);
        });
      }
    });
  }


</script>